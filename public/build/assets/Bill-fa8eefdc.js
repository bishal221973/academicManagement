import{d as v,x as w,q as V,y,o as m,e as p,b as g,c as S,f as x,T as _,a as t,i as k,u as a,F as T,h as A,k as C,v as D,n as L,t as c}from"./app-57419d0c.js";import{S as B,A as F,T as N}from"./AddStudent-2b33b2a0.js";import"./Modal-98fe17cf.js";import"./_plugin-vue_export-helper-c27b6911.js";const j={class:"w-full border-[1px] border-gray-300 rounded-md flex px-3"},q={__name:"SelectAllStudent",props:{modelValue:[String,Number],sectionId:[String,Number],addButton:{type:Boolean,default:!0}},emits:["update:modelValue"],setup(n,{emit:d}){const s=n,u=d,b=v([]),i=async(e=null)=>{const o=await axios.get(route("student.all"),{params:{isAllStudent:!0}});b.value=o.data.students};w(()=>{i(),Pusher.logToConsole=!0;var e=new Pusher("09a7a9ef059d4f63aa24",{cluster:"ap2"});e.subscribe("my-channel").bind("section-event",()=>{i()})});const f=e=>e&&e.length>0?e.map(l=>({label:l==null?void 0:l.name,value:l.id})):[],r=V(()=>f(b.value));return y(()=>s.sectionId,e=>{i(e)}),(e,o)=>(m(),p("div",j,[g(B,{options:r.value,label:"Date Format *",placeholder:"Select student",isForm:!0,"onUpdate:modelValue":o[0]||(o[0]=l=>u("update:modelValue",l)),modelValue:n.modelValue},null,8,["options","modelValue"]),n.addButton?(m(),S(F,{key:0,isSelect:!0})):x("",!0)]))}},O={style:{width:"400px"}},R={class:"p-3 rounded bg-white shadow",style:{"min-height":"calc(100vh - 300px)"}},U={class:"flex justify-between"},$={style:{height:"calc(100vh - 430px)","overflow-y":"auto"}},I={key:0,class:"mt-3 text-gray-400 text-sm"},M={class:"text-gray-500"},G={class:"flex items-center gap-2"},P=["onClick"],z=["onClick"],E={class:"block mt-3"},H={class:"flex items-center justify-between gap-3"},J={class:"flex items-center"},K={class:"block mt-3 bg-gray-100 p-3 rounded"},Q={class:"flex justify-between"},W={class:"flex justify-between"},X={class:"flex justify-between"},se={__name:"Bill",props:{student:Object,orderList:Array,increase:Function,decrease:Function,clearOrder:Function},setup(n){const d=n,s=_({sub_total:0,discount:0,discountAmt:0,is_percentage:!1,grandTotal:0,orderList:[],student_id:""});y(()=>d.orderList,(r,e)=>{console.log("Order list changed:",r),s.sub_total=d.orderList.reduce((o,l)=>o+l.rate*l.qty,0),s.orderList=d==null?void 0:d.orderList,i()},{deep:!0});const u=v(0),b=()=>{if(s.is_percentage)if(s.sub_total>0){const r=s.sub_total*s.discount/100;u.value=r.toFixed(2)}else u.value="0.0";else u.value=Number(s.discount).toFixed(2);s.discountAmt=u.value,i()};y([()=>s.is_percentage,()=>s.discount],()=>{b()});const i=()=>{const r=Number(s.sub_total)-Number(s.discountAmt);s.grandTotal=r},f=()=>{s.post(route("sell.store"),{onSuccess:()=>{s.reset(),d.clearOrder()}})};return(r,e)=>{var o;return m(),p("div",O,[t("div",R,[t("form",{onSubmit:k(f,["prevent"])},[t("div",U,[g(q,{addButton:!1,modelValue:a(s).student_id,"onUpdate:modelValue":e[0]||(e[0]=l=>a(s).student_id=l)},null,8,["modelValue"])]),t("div",$,[n.orderList.length===0?(m(),p("div",I," No items added yet. ")):x("",!0),(m(!0),p(T,null,A(n.orderList,l=>(m(),p("div",{key:l.id,class:"mt-3 border-b pb-2 flex justify-between items-center"},[t("div",null,[t("small",null,[t("b",null,c(l.product),1)]),e[3]||(e[3]=t("br",null,null,-1)),t("small",M,"Rs. "+c(l.rate*l.qty),1)]),t("div",G,[t("button",{type:"button",class:"px-2 py-1 bg-gray-200 rounded",onClick:h=>n.decrease(l.id)},"-",8,P),t("span",null,c(l.qty),1),t("button",{type:"button",class:"px-2 py-1 bg-gray-200 rounded",onClick:h=>n.increase(l.id,l.qty1)},"+",8,z)])]))),128))]),e[13]||(e[13]=t("hr",{class:"my-3"},null,-1)),t("div",E,[t("div",H,[e[6]||(e[6]=t("label",{for:""},"Discount",-1)),t("div",J,[e[4]||(e[4]=t("small",{class:"block mr-1"},"रु",-1)),g(N,{modelValue:a(s).is_percentage,"onUpdate:modelValue":e[1]||(e[1]=l=>a(s).is_percentage=l),onColor:"#fff",offColor:"#ccc",class:"relative top-[2px]"},null,8,["modelValue"]),e[5]||(e[5]=t("small",{class:"block pl-3",style:{"padding-left":"25px"}},"%",-1))])]),C(t("input",{type:"text","onUpdate:modelValue":e[2]||(e[2]=l=>a(s).discount=l),class:L([(o=n.student)!=null&&o.id?"pointer-events-none bg-gray-100":"","w-full border border-gray-300 rounded px-3 py-2 mt-1 focus:outline-none focus:ring-2 focus:ring-blue-500"]),placeholder:"Discounts"},null,2),[[D,a(s).discount]])]),t("div",K,[t("div",Q,[e[7]||(e[7]=t("small",null," Sub Total ",-1)),t("small",null," Rs. "+c(a(s).sub_total),1)]),e[10]||(e[10]=t("hr",{class:"my-1"},null,-1)),t("div",W,[e[8]||(e[8]=t("small",null," Discount ",-1)),t("small",null," Rs. "+c(a(s).discountAmt),1)]),e[11]||(e[11]=t("hr",{class:"my-1"},null,-1)),t("div",X,[e[9]||(e[9]=t("small",null," Grand Total ",-1)),t("small",null," Rs. "+c(a(s).grandTotal),1)]),e[12]||(e[12]=t("button",{class:"w-full mt-3 bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700",type:"submit"}," Save ",-1))])],32)])])}}};export{se as default};
