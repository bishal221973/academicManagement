import{q as v,o as s,e as l,a as o,n as E,S as G,L as j,U as k,d as g,k as O,z as H,F as f,h as _,t as m,v as J,f as b,b as $,r as F,c as S,w as V,u as P,p as R,T as K,Q as W}from"./app-57419d0c.js";import"./AddStudent-2b33b2a0.js";import{_ as I}from"./_plugin-vue_export-helper-c27b6911.js";import{C as X,E as Z,a as ee,b as te,c as ae}from"./ExportPrint-1535eb17.js";import"./Modal-98fe17cf.js";/* empty css                                                              */const ne=["checked"],se={__name:"Switch",props:{modelValue:{type:Boolean,default:!1},size:{type:String,default:"md"},onColor:{type:String,default:"#fff"},offColor:{type:String,default:"#ccc"},route:String},emits:["update:modelValue"],setup(n,{emit:r}){const h=n,c=r,d=v({get:()=>h.modelValue,set:y=>c("update:modelValue",y)}),L=async y=>{d.value=y.target.checked;const p=y.target.checked;d.value=p;try{await j.put(h.route,{status:p}),k.mixin({toast:!0,position:"top-end",showConfirmButton:!1,timer:3e3,timerProgressBar:!0,didOpen:w=>{w.onmouseenter=k.stopTimer,w.onmouseleave=k.resumeTimer}}).fire({icon:"success",title:"Status changed successfully !"})}catch(U){console.error("Failed to update status:",U),d.value=!p}},x=v(()=>{switch(h.size){case"sm":return"h-4 w-8";case"lg":return"h-8 w-16";default:return"h-6 w-12"}});return(y,p)=>(s(),l("label",{class:E(["switch",x.value]),style:G({backgroundColor:d.value?n.onColor:n.offColor})},[o("input",{type:"checkbox",checked:d.value,onChange:L},null,40,ne),p[0]||(p[0]=o("span",{class:"slider round"},null,-1))],6))}},le=I(se,[["__scopeId","data-v-06f378a3"]]),oe={class:"w-full rounded-2xl bg-white backdrop-blur-md p-4 shadow-lg relative"},re={class:"mb-3 flex justify-between items-center flex-wrap gap-3"},ie={class:"flex items-center gap-3"},ue={class:"flex"},de=["value"],ce={class:"flex gap-2 flex-wrap items-center"},fe=["onClick"],me={class:"flex items-center text-[11px]"},ye={class:"block"},pe={class:"block"},he={key:0,class:"text-green-600 font-semibold"},xe={key:1,class:"text-red-600 font-semibold"},ve={class:"block"},ge=["src"],be={class:"block"},ke={class:"block"},we={key:0,class:"flex gap-2"},Ce={key:1},Se={key:0,class:"flex gap-2"},Te=["onClick"],Be=["onClick"],De={key:0,class:"text-red-500"},_e=["onClick"],$e={class:"flex justify-between items-center"},Ve={class:"text-[12px]"},Pe={class:"mt-4 flex justify-center gap-2 items-center flex-wrap"},Re=["disabled"],Ue=["onClick"],Ee=["disabled"],Le={__name:"Table",props:{columns:{type:Array,required:!0},data:{type:Array,required:!0},edit:String,status:String,deleteUrl:String,exportTitle:String,payment:Object,filters:{type:Object,default:()=>({})},isInvoice:Boolean,hideActionOfID:String,canEdit:{type:Boolean,default:!0},canDelete:{type:Boolean,default:!0},canCreateSell:{type:Boolean,default:!0},isTrashed:{type:Boolean,default:!1},restoreUrl:{type:String,default:null},showSearch:{type:Boolean,default:!0},linkUrl:String,showUrl:String,addBook:String,addFunction:Function},setup(n){const r=n,h=g(""),c=g(1),d=g(50),L=[50,100,250,500,1e3],x=v(()=>{let a=r.data;if(h.value){const t=h.value.toLowerCase();a=a.filter(e=>Object.values(e).some(i=>String(i).toLowerCase().includes(t)))}if(Object.entries(r.filters).forEach(([t,e])=>{e&&t!=="date_from"&&t!=="date_to"&&t!=="payment_status"&&t!=="return_date_from"&&t!=="return_date_to"&&(a=a.filter(i=>{const u=String(i[t]??"").toLowerCase(),C=String(e).toLowerCase();return u.includes(C)}))}),r.filters.date_from){const t=new Date(r.filters.date_from);a=a.filter(e=>new Date(e.date)>=t)}if(r.filters.date_to){const t=new Date(r.filters.date_to);a=a.filter(e=>new Date(e.date)<=t)}if(r.filters.return_date_from){const t=new Date(r.filters.return_date_from);a=a.filter(e=>new Date(e.return_date)>=t)}if(r.filters.return_date_to){const t=new Date(r.filters.return_date_to);a=a.filter(e=>new Date(e.return_date)<=t)}return r.filters.payment_status&&(a=a.filter(t=>{const e=parseFloat(t.paid.replace("Rs.","").trim()),i=parseFloat(t.total.replace("Rs.","").trim());return r.filters.payment_status==="paid"?(console.log("Paid="+e),console.log("total="+i),e>0&&e>=i):r.filters.payment_status==="unpaid"?e===0:r.filters.payment_status==="partial"?e>0&&e<i:!0})),a}),y=v(()=>Math.ceil(x.value.length/d.value)||1),p=v(()=>{const a=(c.value-1)*d.value;return A==null?void 0:A.value.slice(a,a+d.value)}),U=v(()=>{let a=[];for(let t=1;t<=y.value;t++)a.push(t);return a}),w=a=>{a>=1&&a<=y.value&&(c.value=a)},z=()=>{c.value=1},M=v(()=>{if(!x.value.length)return"No entries found";const a=(c.value-1)*d.value+1,t=Math.min(c.value*d.value,x.value.length);return`Showing ${a} to ${t} of ${x.value.length} entries`}),N=async(a,t=!1)=>{(await k.fire({title:"Are you sure?",text:"You won't be able to revert this!",icon:"warning",showCancelButton:!0,confirmButtonColor:"#d33",cancelButtonColor:"#3085d6",confirmButtonText:"Yes, delete it!"})).isConfirmed&&K({}).delete(route(r==null?void 0:r.deleteUrl,a),{data:{permanent:t},onSuccess:()=>{var i,u;k.fire({toast:!0,position:"top-end",icon:"success",title:((u=(i=W())==null?void 0:i.props)==null?void 0:u.success)||"Deleted successfully!",showConfirmButton:!1,timer:1500,timerProgressBar:!0})},onError:()=>{k.fire({toast:!0,position:"top-end",icon:"error",title:"Failed to delete!",showConfirmButton:!1,timer:1500,timerProgressBar:!0})}})},T=g(null),B=g(null),D=g("asc"),A=v(()=>B.value?[...x.value].sort((a,t)=>{let e=a[B.value],i=t[B.value];return typeof e=="string"&&(e=e.toLowerCase()),typeof i=="string"&&(i=i.toLowerCase()),e<i?D.value==="asc"?-1:1:e>i?D.value==="asc"?1:-1:0}):x.value),Y=a=>{B.value===a?D.value=D.value==="asc"?"desc":"asc":(B.value=a,D.value="asc")};g({});const q=()=>{r.addFunction()},Q=async a=>{(await k.fire({title:"Are you sure?",text:"You won't be able to revert this!",icon:"warning",showCancelButton:!0,confirmButtonColor:"#d33",cancelButtonColor:"#3085d6",confirmButtonText:"Yes, cancel it!"})).isConfirmed&&j.get(route("payment.status",a)).then(e=>{window.location.reload()})};return(a,t)=>(s(),l("div",oe,[o("div",re,[o("div",ie,[o("div",ue,[O(o("select",{id:"paginationSelect","onUpdate:modelValue":t[0]||(t[0]=e=>d.value=e),onChange:z,class:"px-2 py-[3px] text-[13px] w-[60px] rounded border border-main/20"},[(s(),l(f,null,_(L,e=>o("option",{key:e,value:e},m(e),9,de)),64))],544),[[H,d.value]])]),n.showSearch?O((s(),l("input",{key:0,"onUpdate:modelValue":t[1]||(t[1]=e=>h.value=e),onInput:t[2]||(t[2]=(...e)=>a.onSearch&&a.onSearch(...e)),type:"text",placeholder:"Search...",class:"px-4 py-1 text-[12px] rounded-xl shadow-inner border border-main/20 focus:outline-none focus:ring-1 focus:ring-[#9e0105] text-slate-900 w-50"},null,544)),[[J,h.value]]):b("",!0)]),o("div",ce,[$(X,{exportTitle:n.exportTitle,columns:n.columns,data:n.data},null,8,["exportTitle","columns","data"]),$(Z,{exportTitle:n.exportTitle,columns:n.columns,data:n.data,tableRef:T.value},null,8,["exportTitle","columns","data","tableRef"]),$(ee,{exportTitle:n.exportTitle,columns:n.columns,data:n.data,tableRef:T.value},null,8,["exportTitle","columns","data","tableRef"]),$(te,{exportTitle:n.exportTitle,columns:n.columns,data:n.data,tableRef:T.value},null,8,["exportTitle","columns","data","tableRef"]),$(ae,{exportTitle:n.exportTitle,columns:n.columns,data:n.data,tableRef:T.value},null,8,["exportTitle","columns","data","tableRef"])])]),F(a.$slots,"default",{},void 0,!0),o("table",{ref_key:"tableRef",ref:T,class:"display stripe hover w-full"},[o("thead",null,[o("tr",null,[(s(!0),l(f,null,_(n.columns,e=>(s(),l("th",{class:"py-[9px] px-3 cursor-pointer select-none",key:e.key,onClick:i=>Y(e.key)},[o("div",me,m(e.label),1)],8,fe))),128))])]),o("tbody",null,[(s(!0),l(f,null,_(p.value,(e,i)=>(s(),l("tr",{key:i,class:E(e.is_returned==1?"line-through":"")},[(s(!0),l(f,null,_(n.columns,u=>(s(),l("td",{class:"py-[9px] px-3 cursor-pointer",key:u.key},[u.key==="status"?(s(),l(f,{key:0},[n.status?(s(),S(le,{key:0,route:a.route(n.status,e.actions),modelValue:e.status,"onUpdate:modelValue":C=>e.status=C,onColor:"#fff",offColor:"#ccc"},null,8,["route","modelValue","onUpdate:modelValue"])):b("",!0)],64)):u.key==="student_name"?(s(),l(f,{key:1},[],64)):u.key==="link"?(s(),S(P(R),{key:2,href:n.linkUrl+"?expense="+e.link,class:"text-blue-800"},{default:V(()=>[o("span",ye,m(e.link),1)]),_:2},1032,["href"])):u.key==="view"?(s(),S(P(R),{key:3,href:e.url,class:"text-blue-800"},{default:V(()=>[o("span",pe,m(e.view),1)]),_:2},1032,["href"])):u.key==="boolean"?(s(),l(f,{key:4},[e.boolean?(s(),l("span",he," Active ")):(s(),l("span",xe," Inactive "))],64)):u.key==="show"?(s(),S(P(R),{key:5,href:a.route(n.showUrl,e.actions),class:"text-blue-800"},{default:V(()=>[o("span",ve,m(e.show),1)]),_:2},1032,["href"])):u.key==="image"?(s(),l("img",{key:6,src:"/storage/"+e.image,class:"h-[40px]",alt:""},null,8,ge)):u.key==="student_contact"?(s(),l(f,{key:7},[o("span",be,m(e.phone),1),o("small",ke,m(e.email),1)],64)):u.key==="actions"?(s(),l(f,{key:8},[n.isTrashed?(s(),l("div",we)):(s(),l("div",Ce,[e.is_returned!=1&&n.hideActionOfID!=e.actions?(s(),l("div",Se,[F(a.$slots,"invoice",{row:e},void 0,!0),n.payment&&n.canCreateSell?(s(),S(P(R),{key:0,href:a.route(n.payment)+"?student_id="+e.actions,class:"royal-payment-btn flex items-center gap-1 px-3 py-2 font-semibold text-white rounded-xl shadow-md transition-all duration-300"},{default:V(()=>[...t[5]||(t[5]=[o("i",{class:"fa fa-money-bill"},null,-1)])]),_:1},8,["href"])):b("",!0),n.edit&&n.canEdit?(s(),S(P(R),{key:1,href:a.route(n.edit,e[["actions"]]),class:"royal-edit-btn h-[25px] w-[30px] flex items-center gap-1 px-3 py-2 font-semibold text-white rounded-lg shadow-md transition-all duration-300"},{default:V(()=>[...t[6]||(t[6]=[o("i",{class:"fa fa-pen text-[10px]"},null,-1)])]),_:1},8,["href"])):b("",!0),n.deleteUrl&&n.canDelete?(s(),l("button",{key:2,onClick:C=>N(e[u.key]),class:"royal-delete-btn h-[25px] w-[30px] flex items-center gap-1 px-3 py-0 font-semibold text-white rounded-lg shadow-md transition-all duration-300"},[...t[7]||(t[7]=[o("i",{class:"fa fa-trash text-[10px]"},null,-1)])],8,Te)):b("",!0),n.addBook?(s(),l("button",{key:3,onClick:C=>q(e[u.key]),class:"royal-delete-btn h-[25px] w-[30px] flex items-center gap-1 px-3 py-0 font-semibold text-white rounded-lg shadow-md transition-all duration-300"},[...t[8]||(t[8]=[o("i",{class:"fa fa-plus text-[10px]"},null,-1)])],8,Be)):b("",!0)])):b("",!0)]))],64)):u.key==="cancelPayment"?(s(),l(f,{key:9},[e.status=="canceled"?(s(),l("span",De,"Canceled")):(s(),l("button",{key:1,onClick:C=>Q(e[u.key]),class:"bg-red-100 text-red-500 px-3 py-1 rounded"}," Cancel Payment ",8,_e))],64)):(s(),l("span",{key:10,class:E(e.status=="canceled"?"line-through":"")},m(e[u.key]),3))]))),128))],2))),128)),F(a.$slots,"customTr",{datas:p.value},void 0,!0)])],512),o("div",$e,[o("span",Ve,m(M.value),1),o("div",Pe,[o("button",{onClick:t[3]||(t[3]=e=>w(c.value-1)),disabled:c.value===1,class:"px-3 py-1 rounded-lg text-[12px] bg-[#D9A250] text-white disabled:bg-gray-300 transition"}," ‹ ",8,Re),(s(!0),l(f,null,_(U.value,e=>(s(),l("button",{key:e,onClick:i=>w(e),class:E(["px-3 py-1 rounded-lg transition text-[12px]",e===c.value?"bg-[#ef4444] text-white font-bold":"bg-gray-200 text-gray-700 hover:bg-gray-300"])},m(e),11,Ue))),128)),o("button",{onClick:t[4]||(t[4]=e=>w(c.value+1)),disabled:c.value===y.value,class:"px-3 py-1 rounded-lg bg-[#ef4444] text-white text-[12px] disabled:bg-gray-300 transition"}," › ",8,Ee)])])]))}},Me=I(Le,[["__scopeId","data-v-75f14017"]]);export{Me as T};
