import{a as X,_ as Y}from"./AppLayout-8c26fc8d.js";import{B as Z}from"./Breadcrumb-74eda663.js";import{S as Q}from"./AddStudent-2b33b2a0.js";import{_ as G}from"./Modal-98fe17cf.js";import{d as w,x as H,q as $,o as u,e as p,b as S,T as ee,y as te,a as e,g as C,w as A,i as le,k as N,u as _,v as j,F as D,Q as ae,t as c,f as V,h as B,n as J,z as se,r as z,c as O}from"./app-57419d0c.js";/* empty css                                                                    *//* empty css                                                                        */import{_ as oe}from"./_plugin-vue_export-helper-c27b6911.js";import{C as ne,E as re,a as ue,b as de,c as ie}from"./ExportPrint-1535eb17.js";/* empty css                                                                *//* empty css                                                                           */import"./printer-8ef20624.js";const ce={class:"w-full border-[1px] border-gray-300 rounded-md flex px-3"},pe={__name:"SelectInvoice",props:{modelValue:[String,Number]},emits:["update:modelValue"],setup(d,{emit:b}){const g=b,x=w([]),t=async()=>{const i=await axios.get(route("billing.all.api"));x.value=i.data};H(()=>{t(),Pusher.logToConsole=!0;var i=new Pusher("09a7a9ef059d4f63aa24",{cluster:"ap2"});(i==null?void 0:i.subscribe("my-channel")).bind("unit-event",()=>{t()})});const T=i=>i?i.map(y=>({label:y==null?void 0:y.bill_no,value:y.id})):[],r=$(()=>T(x.value));return(i,y)=>(u(),p("div",ce,[S(Q,{options:r.value,label:"Date Format *",placeholder:"Select bill number",isForm:!0,"onUpdate:modelValue":y[0]||(y[0]=h=>g("update:modelValue",h)),modelValue:d.modelValue},null,8,["options","modelValue"])]))}},fe={class:"w-full border-[1px] border-gray-300 rounded-md flex px-3"},be={__name:"SelectPaymentMode",props:{modelValue:[String,Number]},emits:["update:modelValue"],setup(d,{emit:b}){const g=b,x=w([]),t=async()=>{const i=await axios.get(route("paymentMode.all.api"));x.value=i.data};H(()=>{t(),Pusher.logToConsole=!0;var i=new Pusher("09a7a9ef059d4f63aa24",{cluster:"ap2"});(i==null?void 0:i.subscribe("my-channel")).bind("group-event",()=>{t()})});const T=i=>i?i.map(y=>({label:y==null?void 0:y.name,value:y.id})):[],r=$(()=>T(x.value));return(i,y)=>(u(),p("div",fe,[S(Q,{options:r.value,label:"Date Format *",placeholder:"Select payment mode",isForm:!0,"onUpdate:modelValue":y[0]||(y[0]=h=>g("update:modelValue",h)),modelValue:d.modelValue},null,8,["options","modelValue"])]))}},ve={class:"mb-3"},xe={class:"mb-3"},ye={class:"mb-3"},me={class:"mb-3"},_e={class:"mb-3"},ge={__name:"Payment",props:{billID:String,studentId:String},setup(d){const b=d,g=w(!1),x=()=>{g.value=!g.value},t=w(b.billID),T=w(new Date().toISOString().split("T")[0]),r=ee({bill_id:"",payment_mode_id:1,payment_date:T.value,amount:0,remarks:"",student_id:b.studentId}),i=async h=>{const a=await axios.get(route("billing.find",h));console.log(a.data),r.bill_id=a.data.id,r.amount=a.data.total_amount-a.data.total_paid};te(()=>b.billID,h=>{h&&(t.value=h,i(h))},{immediate:!0});const y=()=>{r.post(route("payment.store"),{onSuccess:()=>{r.reset(),x()}})};return(h,a)=>(u(),p(D,null,[e("button",{onClick:x,class:"text-blue-600 hover:underline"},[...a[6]||(a[6]=[e("i",{class:"fa fa-money-bill"},null,-1),C(" Make Payment ",-1)])]),S(G,{show:g.value,title:"Make Payment",maxWidth:"md",onClose:x},{default:A(()=>[e("form",{onSubmit:le(y,["prevent"])},[e("div",ve,[a[7]||(a[7]=e("label",{for:""},"Bill Number",-1)),N(e("input",{type:"text","onUpdate:modelValue":a[0]||(a[0]=s=>_(r).bill_id=s)},null,512),[[j,_(r).bill_id]]),S(pe,{modelValue:_(r).bill_id,"onUpdate:modelValue":a[1]||(a[1]=s=>_(r).bill_id=s)},null,8,["modelValue"])]),e("div",xe,[a[8]||(a[8]=e("label",{for:""},"Payment Mode",-1)),S(be,{modelValue:_(r).payment_mode_id,"onUpdate:modelValue":a[2]||(a[2]=s=>_(r).payment_mode_id=s)},null,8,["modelValue"])]),e("div",ye,[a[9]||(a[9]=e("label",{for:""},"Payment Date",-1)),N(e("input",{"onUpdate:modelValue":a[3]||(a[3]=s=>_(r).payment_date=s),type:"date",class:"text-[12px] w-full border border-gray-300 rounded px-3 py-2 mt-1 focus:outline-none focus:ring-2 focus:ring-blue-500"},null,512),[[j,_(r).payment_date]])]),e("div",me,[a[10]||(a[10]=e("label",{for:""},"Amount",-1)),N(e("input",{"onUpdate:modelValue":a[4]||(a[4]=s=>_(r).amount=s),type:"number",step:"0.05",placeholder:"Amount",class:"text-[12px] w-full border border-gray-300 rounded px-3 py-2 mt-1 focus:outline-none focus:ring-2 focus:ring-blue-500"},null,512),[[j,_(r).amount]])]),e("div",_e,[a[11]||(a[11]=e("label",{for:""},"Remarks",-1)),N(e("textarea",{"onUpdate:modelValue":a[5]||(a[5]=s=>_(r).remarks=s),placeholder:"Remarks",rows:"4",class:"text-[12px] w-full border border-gray-300 rounded px-3 py-2 mt-1 focus:outline-none focus:ring-2 focus:ring-blue-500"},null,512),[[j,_(r).remarks]])]),a[12]||(a[12]=e("div",{class:"flex justify-end"},[e("button",{class:"bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700",type:"submit"}," Make Payment ")],-1))],32)]),_:1},8,["show"])],64))}},he={class:"flex gap-3 items-center"},ke={class:"text-[20px] block font-bold"},we={class:"text-[15px] block"},Se={key:0,class:"text-[15px] mr-5"},Te={key:1,class:"text-[15px]"},De={class:"mt-5"},$e={class:"flex justify-between"},Ie={class:"text-[18px]"},Ce={key:0,class:"text-[14px] block"},Re={key:1,class:"text-[14px] block"},Ve={class:"flex"},Be={class:"block"},Pe={class:"flex"},Me={class:"block"},Fe={class:"w-full mt-5"},Ne={class:"text-left p-2"},Ue={class:"text-left p-2"},je={key:0},Ee={class:"text-left p-2"},Le={key:0},Oe={key:1},Ae={class:"text-left p-2"},qe={key:0},We={key:1},ze={class:"text-left p-2"},Qe={class:"flex mt-3 justify-between"},Ge={class:"block"},He={class:"flex border-b-[2px] py-2"},Je={class:"ml-2"},Ke={class:"flex border-b-[2px] py-2"},Xe={class:"ml-2"},Ye={class:"ml-2"},Ze={class:"flex border-b-[2px] py-2"},et={class:"ml-2"},tt={__name:"Invoice",props:{invoiceID:String},setup(d){const b=w(!1),g=d,x=()=>{b.value=!b.value},t=w([]),T=async()=>{const a=await axios.get(route("billing.findBillingID",g.invoiceID));console.log(a.data),t.value=a.data,x()},r=ae().props.academy,i=$(()=>{var a,s;return(a=t==null?void 0:t.value)!=null&&a.created_at?new Date((s=t==null?void 0:t.value)==null?void 0:s.created_at).toISOString().split("T")[0]:""}),y=["","Baisakh","Jestha","Ashadh","Shrawan","Bhadra","Ashwin","Kartik","Mangsir","Poush","Magh","Falgun","Chaitra"],h=a=>{if(!a||isNaN(a))return"";const s=["","One","Two","Three","Four","Five","Six","Seven","Eight","Nine","Ten","Eleven","Twelve","Thirteen","Fourteen","Fifteen","Sixteen","Seventeen","Eighteen","Nineteen"],P=["","","Twenty","Thirty","Forty","Fifty","Sixty","Seventy","Eighty","Ninety"],k=v=>v<20?s[v]:v<100?P[Math.floor(v/10)]+(v%10?" "+s[v%10]:""):v<1e3?s[Math.floor(v/100)]+" Hundred"+(v%100?" "+k(v%100):""):v<1e5?k(Math.floor(v/1e3))+" Thousand"+(v%1e3?" "+k(v%1e3):""):v<1e7?k(Math.floor(v/1e5))+" Lakh"+(v%1e5?" "+k(v%1e5):""):"";return k(Number(a))+" Only"};return $(()=>{var a;return(a=t==null?void 0:t.value)!=null&&a.sub_total?h(t.value.sub_total):""}),(a,s)=>(u(),p(D,null,[e("button",{class:"text-blue-500",onClick:T},c(d.invoiceID),1),S(G,{show:b.value,onClose:x,title:"Invoice"},{default:A(()=>{var P,k,v,R,M,E,n,o,l,m,I,L,q,W;return[e("div",null,[e("div",he,[S(X,{class:"h-[50px]"}),e("div",null,[e("span",ke,c(_(r).name),1),e("span",we,c(_(r).address),1),_(r).academy_email?(u(),p("span",Se,[s[0]||(s[0]=e("i",{class:"fa fa-envelope text-[12px] text-blue-400 mr-1"},null,-1)),C(c(_(r).academy_email),1)])):V("",!0),_(r).phone?(u(),p("span",Te,[s[1]||(s[1]=e("i",{class:"fa fa-phone text-[12px] text-blue-400 mr-1"},null,-1)),C(c(_(r).phone),1)])):V("",!0)])]),e("div",De,[s[6]||(s[6]=e("span",{class:"text-[15px]"},"Invoice To",-1)),e("div",$e,[e("div",null,[e("b",Ie,c((k=(P=t.value)==null?void 0:P.student)==null?void 0:k.name),1),(R=(v=t.value)==null?void 0:v.student)!=null&&R.phone?(u(),p("span",Ce,[s[2]||(s[2]=e("i",{class:"fa fa-phone text-[12px] text-gray-400 mr-1"},null,-1)),C(c((E=(M=t.value)==null?void 0:M.student)==null?void 0:E.phone),1)])):V("",!0),(o=(n=t.value)==null?void 0:n.student)!=null&&o.email?(u(),p("span",Re,[s[3]||(s[3]=e("i",{class:"fa fa-envelope text-[12px] text-gray-400 mr-1"},null,-1)),C(c((m=(l=t.value)==null?void 0:l.student)==null?void 0:m.email),1)])):V("",!0)]),e("div",null,[e("div",Ve,[s[4]||(s[4]=e("b",{class:"block w-[100px]"},"Bill number:",-1)),e("span",Be,c((I=t.value)==null?void 0:I.bill_no),1)]),e("div",Pe,[s[5]||(s[5]=e("b",{class:"block w-[100px]"},"Date:",-1)),e("span",Me,c(i.value),1)])])])]),e("div",null,[e("table",Fe,[s[9]||(s[9]=e("thead",{class:"bg-blue-400"},[e("tr",null,[e("th",{class:"text-left p-2 text-white"},"S.N."),e("th",{class:"text-left p-2 text-white"},"Description"),e("th",{class:"text-left p-2 text-white"},"Rate"),e("th",{class:"text-left p-2 text-white"},"Qty"),e("th",{class:"text-left p-2 text-white"},"Amount")])],-1)),e("tbody",null,[(u(!0),p(D,null,B((L=t.value)==null?void 0:L.items,(f,F)=>{var U;return u(),p("tr",{key:F,class:J(F%2==1?"bg-gray-100":"")},[e("td",Ne,c(F+1),1),e("td",Ue,[C(c(f==null?void 0:f.title)+" ",1),f.title=="Tution Fees"?(u(),p("div",je,[s[7]||(s[7]=C(" (",-1)),e("span",null,c(t.value.months.map(K=>y[K.month]).join(" / ")),1),s[8]||(s[8]=C(") ",-1))])):V("",!0)]),e("td",Ee,[f.title=="Tution Fees"?(u(),p("div",Le," Rs. "+c((U=t.value.months[0])==null?void 0:U.amount),1)):(u(),p("div",Oe," Rs. "+c(f==null?void 0:f.amount),1))]),e("td",Ae,[f.title=="Tution Fees"?(u(),p("div",qe,c(t.value.months.length),1)):(u(),p("div",We,c((f==null?void 0:f.qty)<=0?1:f==null?void 0:f.qty),1))]),e("td",ze,"Rs. "+c(f==null?void 0:f.amount),1)],2)}),128))])]),e("div",Qe,[e("div",Ge,[s[10]||(s[10]=e("b",{class:"text-[18px] uppercase block"},"Payment Info",-1)),e("small",null,c(h(t.value.total_amount)),1)]),e("div",null,[e("div",He,[s[11]||(s[11]=e("b",null,"Sub Total:",-1)),e("b",Je,"Rs. "+c(t.value.sub_total),1)]),e("div",Ke,[s[12]||(s[12]=e("b",null,"Discount:",-1)),e("b",Xe,"Rs. "+c((q=t.value)==null?void 0:q.discount),1)]),(u(!0),p(D,null,B((W=t.value)==null?void 0:W.taxes,f=>{var F,U;return u(),p("div",{class:"flex border-b-[2px] py-2",key:f.id},[e("b",null,c((F=f==null?void 0:f.tax)==null?void 0:F.name)+"("+c((U=f==null?void 0:f.tax)==null?void 0:U.percentage)+"%):",1),e("b",Ye,"Rs. "+c(f==null?void 0:f.amount),1)])}),128)),e("div",Ze,[s[13]||(s[13]=e("b",null,"Total:",-1)),e("b",et,"Rs. "+c(t.value.total_amount),1)])])])])])]}),_:1},8,["show"])],64))}};const lt={class:"w-full rounded-2xl bg-white backdrop-blur-md p-4 shadow-lg relative"},at={class:"mb-3 flex justify-between items-center flex-wrap gap-3"},st={class:"flex items-center gap-3"},ot={class:"flex"},nt=["value"],rt={class:"flex gap-2 flex-wrap items-center"},ut=["onClick"],dt={class:"flex items-center text-[11px]"},it={class:"flex justify-between items-center"},ct={class:"text-[12px]"},pt={class:"mt-4 flex justify-center gap-2 items-center flex-wrap"},ft=["disabled"],bt=["onClick"],vt=["disabled"],xt={__name:"TableBill",props:{columns:{type:Array,required:!0},data:{type:Array,required:!0},edit:String,status:String,deleteUrl:String,exportTitle:String,payment:Object,filters:{type:Object,default:()=>({})},isInvoice:Boolean,hideActionOfID:String,canEdit:{type:Boolean,default:!0},canDelete:{type:Boolean,default:!0},canCreateSell:{type:Boolean,default:!0},isTrashed:{type:Boolean,default:!1},restoreUrl:{type:String,default:null},showSearch:{type:Boolean,default:!0},linkUrl:String,showUrl:String,addBook:String,addFunction:Function},setup(d){const b=d,g=w(""),x=w(1),t=w(50),T=[50,100,250,500,1e3],r=$(()=>{let n=b.data;if(g.value){const o=g.value.toLowerCase();n=n.filter(l=>Object.values(l).some(m=>String(m).toLowerCase().includes(o)))}if(Object.entries(b.filters).forEach(([o,l])=>{l&&o!=="date_from"&&o!=="date_to"&&o!=="payment_status"&&o!=="return_date_from"&&o!=="return_date_to"&&(n=n.filter(m=>{const I=String(m[o]??"").toLowerCase(),L=String(l).toLowerCase();return I.includes(L)}))}),b.filters.date_from){const o=new Date(b.filters.date_from);n=n.filter(l=>new Date(l.date)>=o)}if(b.filters.date_to){const o=new Date(b.filters.date_to);n=n.filter(l=>new Date(l.date)<=o)}if(b.filters.return_date_from){const o=new Date(b.filters.return_date_from);n=n.filter(l=>new Date(l.return_date)>=o)}if(b.filters.return_date_to){const o=new Date(b.filters.return_date_to);n=n.filter(l=>new Date(l.return_date)<=o)}return b.filters.payment_status&&(n=n.filter(o=>{const l=parseFloat(o.paid.replace("Rs.","").trim()),m=parseFloat(o.total.replace("Rs.","").trim());return b.filters.payment_status==="paid"?(console.log("Paid="+l),console.log("total="+m),l>0&&l>=m):b.filters.payment_status==="unpaid"?l===0:b.filters.payment_status==="partial"?l>0&&l<m:!0})),n}),i=$(()=>Math.ceil(r.value.length/t.value)||1),y=$(()=>{const n=(x.value-1)*t.value;return M==null?void 0:M.value.slice(n,n+t.value)}),h=$(()=>{let n=[];for(let o=1;o<=i.value;o++)n.push(o);return n}),a=n=>{n>=1&&n<=i.value&&(x.value=n)},s=()=>{x.value=1},P=$(()=>{if(!r.value.length)return"No entries found";const n=(x.value-1)*t.value+1,o=Math.min(x.value*t.value,r.value.length);return`Showing ${n} to ${o} of ${r.value.length} entries`}),k=w(null),v=w(null),R=w("asc"),M=$(()=>v.value?[...r.value].sort((n,o)=>{let l=n[v.value],m=o[v.value];return typeof l=="string"&&(l=l.toLowerCase()),typeof m=="string"&&(m=m.toLowerCase()),l<m?R.value==="asc"?-1:1:l>m?R.value==="asc"?1:-1:0}):r.value),E=n=>{v.value===n?R.value=R.value==="asc"?"desc":"asc":(v.value=n,R.value="asc")};return w({}),(n,o)=>(u(),p("div",lt,[e("div",at,[e("div",st,[e("div",ot,[N(e("select",{id:"paginationSelect","onUpdate:modelValue":o[0]||(o[0]=l=>t.value=l),onChange:s,class:"px-2 py-[3px] text-[13px] w-[60px] rounded border border-main/20"},[(u(),p(D,null,B(T,l=>e("option",{key:l,value:l},c(l),9,nt)),64))],544),[[se,t.value]])]),d.showSearch?N((u(),p("input",{key:0,"onUpdate:modelValue":o[1]||(o[1]=l=>g.value=l),onInput:o[2]||(o[2]=(...l)=>n.onSearch&&n.onSearch(...l)),type:"text",placeholder:"Search...",class:"px-4 py-1 text-[12px] rounded-xl shadow-inner border border-main/20 focus:outline-none focus:ring-1 focus:ring-[#9e0105] text-slate-900 w-50"},null,544)),[[j,g.value]]):V("",!0)]),e("div",rt,[S(ne,{exportTitle:d.exportTitle,columns:d.columns,data:d.data},null,8,["exportTitle","columns","data"]),S(re,{exportTitle:d.exportTitle,columns:d.columns,data:d.data,tableRef:k.value},null,8,["exportTitle","columns","data","tableRef"]),S(ue,{exportTitle:d.exportTitle,columns:d.columns,data:d.data,tableRef:k.value},null,8,["exportTitle","columns","data","tableRef"]),S(de,{exportTitle:d.exportTitle,columns:d.columns,data:d.data,tableRef:k.value},null,8,["exportTitle","columns","data","tableRef"]),S(ie,{exportTitle:d.exportTitle,columns:d.columns,data:d.data,tableRef:k.value},null,8,["exportTitle","columns","data","tableRef"])])]),z(n.$slots,"default",{},void 0,!0),e("table",{ref_key:"tableRef",ref:k,class:"display stripe hover w-full"},[e("thead",null,[e("tr",null,[(u(!0),p(D,null,B(d.columns,l=>(u(),p("th",{class:"py-[9px] px-3 cursor-pointer select-none",key:l.key,onClick:m=>E(l.key)},[e("div",dt,c(l.label),1)],8,ut))),128))])]),e("tbody",null,[(u(!0),p(D,null,B(y.value,(l,m)=>(u(),p("tr",{key:m,class:"bg-white hover:bg-gray-50 border-b"},[(u(!0),p(D,null,B(d.columns,I=>(u(),p("td",{key:I.key,class:"px-3 py-2 text-sm text-gray-800"},[I.key==="payment"?(u(),p(D,{key:0},[l.isPaid?V("",!0):(u(),O(ge,{key:0,billID:l.actions,studentId:l.studentId},null,8,["billID","studentId"]))],64)):I.key=="billId"?(u(),O(tt,{key:1,invoiceID:l[I.key]},null,8,["invoiceID"])):(u(),p(D,{key:2},[C(c(l[I.key]),1)],64))]))),128))]))),128)),z(n.$slots,"customTr",{datas:y.value},void 0,!0)])],512),e("div",it,[e("span",ct,c(P.value),1),e("div",pt,[e("button",{onClick:o[3]||(o[3]=l=>a(x.value-1)),disabled:x.value===1,class:"px-3 py-1 rounded-lg text-[12px] bg-[#D9A250] text-white disabled:bg-gray-300 transition"}," ‹ ",8,ft),(u(!0),p(D,null,B(h.value,l=>(u(),p("button",{key:l,onClick:m=>a(l),class:J(["px-3 py-1 rounded-lg transition text-[12px]",l===x.value?"bg-[#ef4444] text-white font-bold":"bg-gray-200 text-gray-700 hover:bg-gray-300"])},c(l),11,bt))),128)),e("button",{onClick:o[4]||(o[4]=l=>a(x.value+1)),disabled:x.value===i.value,class:"px-3 py-1 rounded-lg bg-[#ef4444] text-white text-[12px] disabled:bg-gray-300 transition"}," › ",8,vt)])])]))}},yt=oe(xt,[["__scopeId","data-v-372c4e0c"]]),mt={class:"flex items-center justify-between mb-3"},Vt={__name:"Billing",props:{students:Object,bills:Object},setup(d){const b=d,g=[{label:"S.N.",key:"sn"},{label:"Student",key:"student"},{label:"Bill ID",key:"billId"},{label:"Sub Total",key:"subTotal"},{label:"Discount",key:"discount"},{label:"Tax",key:"tax"},{label:"Total Payable",key:"payable"},{label:"Paid",key:"paid"},{label:"Balance",key:"balance"},{label:"Payment",key:"payment"}],x=$(()=>b.bills.map((t,T)=>{var r,i;return{sn:T+1,student:(r=t==null?void 0:t.student)==null?void 0:r.name,billId:t==null?void 0:t.bill_no,subTotal:"Rs. "+(t==null?void 0:t.sub_total),discount:"Rs. "+t.discount,tax:"Rs. "+(t==null?void 0:t.total_tax),payable:"Rs. "+(t==null?void 0:t.total_amount),paid:"Rs. "+(t==null?void 0:t.total_paid),balance:"Rs. "+((t==null?void 0:t.total_amount)-(t==null?void 0:t.total_paid)<=0?0:(t==null?void 0:t.total_amount)-(t==null?void 0:t.total_paid)),bills:t.items,actions:t.id,studentId:(i=t==null?void 0:t.student)==null?void 0:i.id,isPaid:(t==null?void 0:t.total_amount)-(t==null?void 0:t.total_paid)<=0}}));return(t,T)=>(u(),O(Y,{title:"Dashboard"},{content:A(()=>[e("div",mt,[S(Z,{breadcrumbs:[{label:"Billing"}]})]),S(yt,{columns:g,data:x.value,exportTitle:"Student List",filters:t.filters,edit:"student.edit",deleteUrl:"student.delete"},null,8,["data","filters"])]),_:1}))}};export{Vt as default};
